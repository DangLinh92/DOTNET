@model List<VOC_MSTViewModel>
@using Microsoft.AspNetCore.Authorization
@using VOC.Authorization
@inject IAuthorizationService AuthorizationService

@{
    var pUpdate = await AuthorizationService.AuthorizeAsync(User, "uVoc", Operations.Update);
}

<div class="row">
    <div class="col-sm-12" id="show-hidden-grid-report">
        <ul class="breadcrumb">
            <li class="breadcrumb-item active" style="cursor: pointer;">
                <i class="fa fa-caret-right"></i> <strong>VOC Report 파일추가 (Đối sách báo cáo VOC đính kèm)</strong>
            </li>
        </ul>
    </div>
</div>
<div class="row hidden-grid-report" style="display:none">
    <div class="col-md-12">
        <div class="table-responsive" id="gridVocCompleteMst">
            <table class="table table-bordered table-hover mb-0 table-striped custom-table datatable" id="vocMstCompleteDataTable" style="width:100%">
                <thead>
                    <tr>
                        <th>
                            Received site
                        </th>
                        <th>
                            Place of origin<br />
                            (HQ, WTC, WHC)
                        </th>
                        <th>
                            Received dept.<br />
                            (Sales, Quality)
                        </th>
                        <th>
                            Received date<br />(YYYY-MM-DD)
                        </th>
                        <th>
                            SPL Received date<br />(YYYY-MM-DD)
                        </th>
                        <th>
                            SPL Received date<br />(week),ISO8601
                        </th>
                        <th>Customer</th>
                        <th>
                            SET Model(Customer)
                        </th>
                        <th>
                            Process(Customer)
                        </th>
                        <th>Model(Full name)</th>
                        <th>Defect name/<br />Phenomenon(Customer)</th>
                        <th>
                            Defect rate<br />
                            (defect qty./input qty.)
                        </th>
                        <th>
                            Parts classification1<br />
                            (SAW, Module)
                        </th>
                        <th>
                            Parts classification2<br />
                            (Sample, Mass product)
                        </th>
                        <th>Prodution date<br />(Marking)</th>
                        <th>
                            Defect name
                            (Analysis result)
                        </th>
                        <th>
                            VOC Count
                        </th>
                        <th>Defect cause <br />(Root cause)</th>
                        <th>Defect classification<br />(5M+1E)</th>
                        <th>Customer Response</th>
                        <th>8D Report_Final approver</th>
                        <th>8D Report_Sender</th>
                        <th>8D Rport_sent date</th>
                        <th>
                            VOC State<br />
                            (Close, Open)
                        </th>
                        <th>
                            VOC Finishing date
                        </th>
                        <th>
                            VOC TAT
                        </th>

                      

                        <th>Report sent to customer</th>
                        <th>internal report</th>
                    </tr>
                    <tr>
                        <th>
                        </th>
                        <th>
                        </th>
                        <th>
                        </th>
                        <th>
                        </th>
                        <th>
                        </th>
                        <th>
                        </th>
                        <th></th>
                        <th>
                        </th>
                        <th>
                        </th>
                        <th></th>
                        <th></th>
                        <th>
                        </th>
                        <th>
                        </th>
                        <th>
                        </th>
                        <th></th>
                        <th>
                        </th>
                        <th>
                        </th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th>
                        </th>
                        <th>
                        </th>
                        <th>
                        </th>
                        <th></th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id="tbl-content">
                    @foreach (var voc in Model)
                    {
                        <tr>
                            <td>
                                @voc.Received_site
                                @if (!string.IsNullOrEmpty(voc.LinkReport))
                                {
                                    <ul class="team-members" style="float:right"><li><a class="view-issue" href="#" data-id="@voc.LinkReport" style="border:none"><i class="fa fa-file-powerpoint-o m-r-5" style="margin:7px;"></i> Report</a></li></ul>
                                }
                            </td>
                            <td>@voc.PlaceOfOrigin</td>
                            <td>@voc.ReceivedDept</td>
                            <td>@voc.ReceivedDate</td>
                            <td>@voc.SPLReceivedDate</td>
                            <td>@voc.SPLReceivedDateWeek</td>
                            <td>@voc.Customer</td>
                            <td>@voc.SETModelCustomer</td>
                            <td>@voc.ProcessCustomer</td>
                            <td>@voc.ModelFullname</td>
                            <td>@voc.DefectNameCus</td>
                            <td>@voc.DefectRate</td>
                            <td>@voc.PartsClassification</td>
                            <td>@voc.PartsClassification2</td>
                            <td>@voc.ProdutionDateMarking</td>
                            <td>@voc.AnalysisResult</td>
                            <td>@voc.VOCCount</td>
                            <td>@voc.DefectCause</td>
                            <td>@voc.DefectClassification</td>
                            <td>@voc.CustomerResponse</td>
                            <td>@voc.Report_FinalApprover</td>
                            <td>@voc.Report_Sender</td>
                            <td>@voc.Rport_sentDate</td>
                            <td>@voc.VOCState</td>
                            <td>@voc.VOCFinishingDate</td>
                            <td>@voc.VOC_TAT</td>

                            @*<td class="text-right">
                                    <div class="dropdown dropdown-action">
                                        <a href="#" class="action-icon dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><i class="material-icons">more_vert</i></a>
                                        <div class="dropdown-menu dropdown-menu-right">

                                            @if (string.IsNullOrEmpty(voc.LinkReport) && pUpdate.Succeeded)
                                            {
                                                <a class="dropdown-item upload-issue" href="#" data-toggle="modal" data-target="#uploadIssue" data-id="@voc.Id"><i class="fa fa-upload m-r-5"></i> Upload</a>
                                            }
                                            else
                                            {
                                                <a class="dropdown-item download-issue" href="@voc.LinkReport" data-id="@voc.Id"><i class="fa fa-file-powerpoint-o m-r-5"></i> Report</a>

                                                @if (pUpdate.Succeeded)
                                                {
                                                    <a class="dropdown-item upload-issue" href="#" data-id="@voc.Id"><i class="fa fa-upload m-r-5"></i> Upload</a>
                                                }
                                            }
                                        </div>
                                    </div>
                                </td>*@
                            <td>
                                @if (pUpdate.Succeeded)
                                {
                                    <ul class="team-members">

                                        @if (!string.IsNullOrEmpty(voc.LinkReport))
                                        {
                                            <li>
                                                <a class="view-issue1" href="#" data-id="@voc.LinkReport" style="border:none"><i class="fa fa-eye m-r-5" style="margin:7px;"></i> View</a>
                                            </li>
                                            <li>
                                                <a class="download-issue" target="_blank" href="@voc.LinkReport" download data-id="@voc.Id" style="border:none"><i class="fa fa-file-powerpoint-o m-r-5" style="margin:7px;"></i> Report</a>
                                            </li>
                                        }

                                        <li>
                                            <a class="upload-issue" href="#" data-id="@voc.Id" style="border:none"><i class="fa fa-upload m-r-5" style="margin:7px;"></i> Upload</a>
                                        </li>
                                    </ul>
                                }
                                else
                                {
                                    <ul class="team-members" style="float:right">
                                        @if (!string.IsNullOrEmpty(voc.LinkReport))
                                        {
                                            <li>
                                                <a class="view-issue1" href="#" data-id="@voc.LinkReport" style="border:none"><i class="fa fa-file-powerpoint-o m-r-5" style="margin:7px;"></i> Report</a>
                                            </li>
                                        }
                                    </ul>
                                }
                            </td>
                            <td>
                                @if (pUpdate.Succeeded)
                                {
                                    <ul class="team-members">

                                        @if (!string.IsNullOrEmpty(voc.LinkReport2))
                                        {
                                            <li>
                                                <a class="view-issue2" href="#" data-id="@voc.LinkReport2" style="border:none"><i class="fa fa-eye m-r-5" style="margin:7px;"></i> View</a>
                                            </li>
                                            <li>
                                                <a class="download-issue1" target="_blank" href="@voc.LinkReport2" download data-id="@voc.Id" style="border:none"><i class="fa fa-file-powerpoint-o m-r-5" style="margin:7px;"></i> Report</a>
                                            </li>
                                        }

                                        <li>
                                            <a class="upload-issue1" href="#" data-id="@voc.Id" style="border:none"><i class="fa fa-upload m-r-5" style="margin:7px;"></i> Upload</a>
                                        </li>
                                    </ul>
                                }
                                else
                                {
                                    <ul class="team-members" style="float:right">
                                        @if (!string.IsNullOrEmpty(voc.LinkReport2))
                                        {
                                            <li>
                                                <a class="view-issue2" href="#" data-id="@voc.LinkReport2" style="border:none"><i class="fa fa-file-powerpoint-o m-r-5" style="margin:7px;"></i> Report</a>
                                            </li>
                                        }
                                    </ul>
                                }
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>